<div class="section-container">
  <div class="section-header">
    <h2>Personal Details</h2>
    <p class="section-description">Add additional personal information (all fields are optional)</p>
    <div class="form-actions">
      <button type="button" class="btn-clear-all" (click)="clearAllDetails()">
        <i class="material-icons">delete_sweep</i> Clear All Details
      </button>
    </div>
  </div>

  <div class="form-container">
    <form [formGroup]="detailsForm" class="item-card">
      <div class="form-row">
        <div class="form-group">
          <label for="dateOfBirth">Date of Birth</label>
          <input type="text" id="dateOfBirth" formControlName="dateOfBirth" placeholder="DD/MM/YYYY" />
        </div>

        <div class="form-group">
          <label for="placeOfBirth">Place of Birth</label>
          <input type="text" id="placeOfBirth" formControlName="placeOfBirth" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="nationality">Nationality</label>
          <input type="text" id="nationality" formControlName="nationality" />
        </div>

        <!-- Add an empty div to maintain the grid layout -->
        <div class="form-group"></div>
      </div>

      <!-- Gender and Marital Status Row -->
      <div class="form-row">
        <div class="form-group">
          <label for="gender">Gender</label>
          <select id="gender" formControlName="gender" (change)="updateFormFields()">
            <option value="">Select gender...</option>
            <option *ngFor="let gender of genderOptions" [value]="gender">{{gender}}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="maritalStatus">Marital Status</label>
          <select id="maritalStatus" formControlName="maritalStatus" (change)="updateFormFields()">
            <option value="">Select status...</option>
            <option *ngFor="let status of maritalStatusOptions" [value]="status">{{status}}</option>
          </select>
        </div>
      </div>

      <!-- Religion Row -->
      <div class="form-row">
        <div class="form-group">
          <label for="religion">Religion</label>
          <input type="text" id="religion" formControlName="religion" />
        </div>

        <!-- Conditional field based on gender & marital status -->
        <div class="form-group">
          <label *ngIf="shouldShowHusbandName()" for="parentName">Husband's Name</label>
          <label *ngIf="!shouldShowHusbandName()" for="parentName">Father's Name</label>
          <input type="text" id="parentName" formControlName="parentName" />
        </div>
      </div>

      <!-- Mother's name conditionally shown -->
      <div class="form-row" *ngIf="!shouldShowHusbandName()">
        <div class="form-group">
          <label for="mothersName">Mother's Name</label>
          <input type="text" id="mothersName" formControlName="mothersName" />
        </div>

        <!-- Empty space to maintain grid layout -->
        <div class="form-group"></div>
      </div>

      <!-- Siblings information section -->
      <div class="form-row">
        <div class="form-group">
          <label for="hasSiblingsYes">Do you have siblings?</label>
          <div class="radio-group">
            <label class="radio-label">
              <input
                type="radio"
                id="hasSiblingsYes"
                formControlName="hasSiblings"
                [value]="true"
                (change)="updateSiblingsField()" />
              Yes
            </label>
            <label class="radio-label">
              <input
                type="radio"
                id="hasSiblingsNo"
                formControlName="hasSiblings"
                [value]="false"
                (change)="updateSiblingsField()" />
              No
            </label>
          </div>
        </div>

        <div class="form-group" *ngIf="detailsForm.get('hasSiblings')?.value">
          <label for="siblingCount">Number of Siblings</label>
          <input type="number" id="siblingCount" formControlName="siblingCount" min="0" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="passportNumber">Passport Number</label>
          <input type="text" id="passportNumber" formControlName="passportNumber" />
        </div>

        <div class="form-group">
          <label for="drivingLicense">Driving License</label>
          <input type="text" id="drivingLicense" formControlName="drivingLicense" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="bloodGroup">Blood Group</label>
          <select id="bloodGroup" formControlName="bloodGroup" class="blood-group-select">
            <option value="">Select blood group...</option>
            <optgroup
              *ngFor="let category of bloodGroupCategories"
              [label]="category.name"
              [style.color]="category.color"
              [style.font-weight]="'bold'">
              <option *ngFor="let option of category.options" [value]="option">{{option}}</option>
            </optgroup>
          </select>
        </div>

        <div class="form-group">
          <label for="hobbies">Hobbies (comma separated)</label>
          <input type="text" id="hobbies" formControlName="hobbies" placeholder="Reading, Swimming, Photography" />
        </div>
      </div>

      <div class="form-section">
        <h3>Additional Information</h3>
        <p class="section-description">Add any other information you'd like to include</p>

        <div formArrayName="otherInfo">
          <div *ngFor="let info of otherInfoArray.controls; let i = index" class="other-info-item">
            <div [formGroupName]="i" class="form-row">
              <div class="form-group">
                <label [for]="'otherInfoKey-' + i">Information Type</label>
                <input
                  type="text"
                  [id]="'otherInfoKey-' + i"
                  formControlName="key"
                  placeholder="e.g., Professional Association, Social Security Number" />
              </div>

              <div class="form-group">
                <label [for]="'otherInfoValue-' + i">Information Value</label>
                <input type="text" [id]="'otherInfoValue-' + i" formControlName="value" />
              </div>

              <button type="button" class="btn-remove" (click)="removeInfoField(i)">
                <i class="material-icons">delete</i>
              </button>
            </div>
          </div>
        </div>

        <div class="form-row">
          <button type="button" class="btn btn-add" (click)="addInfoField()">
            <i class="material-icons">add</i> Add More Information
          </button>
        </div>
      </div>
    </form>
  </div>
</div>

<div class="section-navigation with-prev">
  <button type="button" (click)="goToPreviousSection()" class="btn btn-prev">
    <i class="material-icons">arrow_forward</i>
    Previous: Languages
  </button>

  <button type="button" (click)="goToNextSection()" class="btn btn-primary">
    Next: QR Code
    <i class="material-icons">arrow_forward</i>
  </button>
</div>
